{
  "version": 2,
  "type": "butler_project_backup",
  "project": {
    "id": "proj-smart-pantry-odc",
    "name": "SmartPantry ODC",
    "platform": "ODC",
    "description": "Cloud-native household inventory management with Vision AI, Native Scanning, and Predictive Replenishment.",
    "createdAt": "2023-10-27T10:00:00.000Z"
  },
  "modules": [
    {
      "id": "mod-smart-pantry-app",
      "projectId": "proj-smart-pantry-odc",
      "name": "SmartPantry",
      "layer": "Core",
      "odcRole": "App",
      "description": "Main ODC App. Contains Server Data, Local Storage (for Offline), Logic, and UI.",
      "dependencies": [
        {
          "producerModuleId": "mod-vision-sync-lib",
          "elements": [
            { "id": "act-analyze-receipt", "name": "AnalyzeReceiptImage", "type": "Action", "subType": "ServerAction" }
          ]
        },
        {
          "producerModuleId": "mod-native-scanner-lib",
          "elements": [
            { "id": "act-scan-barcode", "name": "ScanBarcode", "type": "Action", "subType": "ClientAction" }
          ]
        }
      ]
    },
    {
      "id": "mod-vision-sync-lib",
      "projectId": "proj-smart-pantry-odc",
      "name": "VisionSync",
      "layer": "Foundation",
      "odcRole": "Library",
      "description": "High-code C# Library wrapping Azure Vision / Tesseract for receipt OCR.",
      "dependencies": []
    },
    {
      "id": "mod-native-scanner-lib",
      "projectId": "proj-smart-pantry-odc",
      "name": "NativeScanner",
      "layer": "Foundation",
      "odcRole": "Library",
      "description": "Mobile Plugin wrapper for hardware barcode scanning.",
      "dependencies": []
    }
  ],
  "entities": [
    {
      "id": "ent-product",
      "moduleId": "mod-smart-pantry-app",
      "name": "Product",
      "description": "Master product definition.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-prod-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-prod-gtin", "name": "GTIN", "dataType": "Text", "length": 50, "isMandatory": true, "isIdentifier": false },
        { "id": "attr-prod-name", "name": "Name", "dataType": "Text", "length": 100, "isMandatory": true, "isIdentifier": false },
        { "id": "attr-prod-unit", "name": "UnitType", "dataType": "Text", "length": 20, "isMandatory": true, "isIdentifier": false },
        { "id": "attr-prod-cal", "name": "CaloriesPerUnit", "dataType": "Decimal", "isMandatory": false, "isIdentifier": false },
        { "id": "attr-prod-avg", "name": "AvgDailyConsumption", "dataType": "Decimal", "isMandatory": false, "isIdentifier": false }
      ]
    },
    {
      "id": "ent-local-product",
      "moduleId": "mod-smart-pantry-app",
      "name": "LocalProduct",
      "description": "Client-side mirror of Product for Offline access.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-lp-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-lp-name", "name": "Name", "dataType": "Text", "length": 100, "isMandatory": true, "isIdentifier": false },
        { "id": "attr-lp-sync", "name": "IsSynced", "dataType": "Boolean", "isMandatory": true, "isIdentifier": false }
      ]
    },
    {
      "id": "ent-inventory",
      "moduleId": "mod-smart-pantry-app",
      "name": "InventoryItem",
      "description": "Physical instances of products.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-inv-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-inv-prod", "name": "ProductId", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-inv-qty", "name": "Quantity", "dataType": "Decimal", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-inv-loc", "name": "Location", "dataType": "Text", "length": 50, "isMandatory": true, "isIdentifier": false },
        { "id": "attr-inv-exp", "name": "ExpirationDate", "dataType": "Date", "isMandatory": false, "isIdentifier": false }
      ]
    },
    {
      "id": "ent-supermarket",
      "moduleId": "mod-smart-pantry-app",
      "name": "Supermarket",
      "description": "Stores for price comparison.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-sup-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-sup-name", "name": "Name", "dataType": "Text", "length": 100, "isMandatory": true, "isIdentifier": false }
      ]
    },
    {
      "id": "ent-price-history",
      "moduleId": "mod-smart-pantry-app",
      "name": "PriceHistory",
      "description": "Historical pricing for Index calculation.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-ph-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-ph-prod", "name": "ProductId", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-ph-sup", "name": "SupermarketId", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-ph-price", "name": "Price", "dataType": "Decimal", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-ph-date", "name": "RecordedAt", "dataType": "DateTime", "isMandatory": true, "isIdentifier": false }
      ]
    },
    {
      "id": "ent-consumption",
      "moduleId": "mod-smart-pantry-app",
      "name": "ConsumptionLog",
      "description": "Log for predictive AI.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-log-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-log-prod", "name": "ProductId", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-log-qty", "name": "QtyConsumed", "dataType": "Decimal", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-log-date", "name": "LogDate", "dataType": "DateTime", "isMandatory": true, "isIdentifier": false }
      ]
    },
    {
      "id": "ent-recipe",
      "moduleId": "mod-smart-pantry-app",
      "name": "Recipe",
      "description": "Cooking instructions.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-rec-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-rec-title", "name": "Title", "dataType": "Text", "length": 200, "isMandatory": true, "isIdentifier": false },
        { "id": "attr-rec-cal", "name": "TotalCalories", "dataType": "Decimal", "isMandatory": false, "isIdentifier": false }
      ]
    },
    {
      "id": "ent-recipe-item",
      "moduleId": "mod-smart-pantry-app",
      "name": "RecipeItem",
      "description": "Link between Recipe and Product.",
      "isStatic": false,
      "isPublic": false,
      "attributes": [
        { "id": "attr-ri-id", "name": "Id", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": true },
        { "id": "attr-ri-rec", "name": "RecipeId", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-ri-prod", "name": "ProductId", "dataType": "LongInteger", "isMandatory": true, "isIdentifier": false },
        { "id": "attr-ri-qty", "name": "RequiredQty", "dataType": "Decimal", "isMandatory": true, "isIdentifier": false }
      ]
    }
  ],
  "actions": [
    {
      "id": "act-analyze-receipt",
      "moduleId": "mod-vision-sync-lib",
      "name": "AnalyzeReceiptImage",
      "type": "Server",
      "description": "Parses an image via Azure Vision OCR.",
      "isFunction": false,
      "isPublic": true,
      "inputs": [{ "id": "in-img", "name": "ImageBinary", "dataType": "Binary", "isList": false, "isMandatory": true }],
      "outputs": [{ "id": "out-json", "name": "ParsedJSON", "dataType": "Text", "isList": false, "isMandatory": false }],
      "flowSummary": "Calls C# Extension.",
      "nodes": [],
      "edges": []
    },
    {
      "id": "act-scan-barcode",
      "moduleId": "mod-native-scanner-lib",
      "name": "ScanBarcode",
      "type": "Client",
      "description": "Opens camera for scanning.",
      "isFunction": false,
      "isPublic": true,
      "inputs": [],
      "outputs": [{ "id": "out-code", "name": "ScannedCode", "dataType": "Text", "isList": false, "isMandatory": false }],
      "flowSummary": "Calls Cordova Plugin.",
      "nodes": [],
      "edges": []
    },
    {
      "id": "act-forecast",
      "moduleId": "mod-smart-pantry-app",
      "name": "Forecast_RunAnalysis",
      "type": "Server",
      "description": "Calculates daily usage and auto-fills shopping list.",
      "isFunction": false,
      "isPublic": false,
      "inputs": [],
      "outputs": [],
      "flowSummary": "Aggregates logs, updates products, adds to shopping list.",
      "nodes": [
        { "id": "n1", "type": "Start", "label": "Start", "posX": 0, "posY": 0 },
        { "id": "n2", "type": "Aggregate", "label": "GetConsumptionLogs", "posX": 0, "posY": 100 },
        { "id": "n3", "type": "Loop", "label": "ForEach Product", "posX": 0, "posY": 200 },
        { "id": "n4", "type": "Assign", "label": "Calc Avg Usage", "posX": 100, "posY": 300 },
        { "id": "n5", "type": "Update", "label": "UpdateProduct", "posX": 100, "posY": 400 },
        { "id": "n6", "type": "Aggregate", "label": "GetInventory", "posX": 100, "posY": 500 },
        { "id": "n7", "type": "If", "label": "Qty < 3 Days?", "posX": 100, "posY": 600 },
        { "id": "n8", "type": "Action", "label": "AddToShoppingList", "posX": 200, "posY": 700 },
        { "id": "n9", "type": "End", "label": "End", "posX": 0, "posY": 800 }
      ],
      "edges": [
        { "id": "e1", "source": "n1", "target": "n2" },
        { "id": "e2", "source": "n2", "target": "n3" },
        { "id": "e3", "source": "n3", "target": "n4", "label": "Cycle" },
        { "id": "e4", "source": "n4", "target": "n5" },
        { "id": "e5", "source": "n5", "target": "n6" },
        { "id": "e6", "source": "n6", "target": "n7" },
        { "id": "e7", "source": "n7", "target": "n8", "label": "True" },
        { "id": "e8", "source": "n7", "target": "n3", "label": "False" },
        { "id": "e9", "source": "n8", "target": "n3" },
        { "id": "e10", "source": "n3", "target": "n9", "label": "End" }
      ]
    },
    {
      "id": "act-adjust-stock",
      "moduleId": "mod-smart-pantry-app",
      "name": "Inventory_AdjustStock",
      "type": "Server",
      "description": "Updates stock and logs consumption.",
      "isFunction": false,
      "isPublic": true,
      "inputs": [
        { "id": "in-p", "name": "ProductId", "dataType": "LongInteger", "isList": false, "isMandatory": true },
        { "id": "in-d", "name": "Delta", "dataType": "Decimal", "isList": false, "isMandatory": true }
      ],
      "outputs": [],
      "flowSummary": "Transactional update logic.",
      "nodes": [
        { "id": "ns1", "type": "Start", "label": "Start", "posX": 0, "posY": 0 },
        { "id": "ns2", "type": "Aggregate", "label": "GetInventoryItem", "posX": 0, "posY": 100 },
        { "id": "ns3", "type": "If", "label": "Exists?", "posX": 0, "posY": 200 },
        { "id": "ns4", "type": "Create", "label": "CreateItem", "posX": -100, "posY": 300 },
        { "id": "ns5", "type": "Assign", "label": "UpdateQty", "posX": 100, "posY": 300 },
        { "id": "ns6", "type": "If", "label": "Delta < 0?", "posX": 0, "posY": 400 },
        { "id": "ns7", "type": "Create", "label": "LogConsumption", "posX": 100, "posY": 500 },
        { "id": "ns8", "type": "End", "label": "End", "posX": 0, "posY": 600 }
      ],
      "edges": [
        { "id": "es1", "source": "ns1", "target": "ns2" },
        { "id": "es2", "source": "ns2", "target": "ns3" },
        { "id": "es3", "source": "ns3", "target": "ns4", "label": "False" },
        { "id": "es4", "source": "ns3", "target": "ns5", "label": "True" },
        { "id": "es5", "source": "ns4", "target": "ns6" },
        { "id": "es6", "source": "ns5", "target": "ns6" },
        { "id": "es7", "source": "ns6", "target": "ns7", "label": "True" },
        { "id": "es8", "source": "ns6", "target": "ns8", "label": "False" },
        { "id": "es9", "source": "ns7", "target": "ns8" }
      ]
    },
    {
      "id": "act-offline-sync",
      "moduleId": "mod-smart-pantry-app",
      "name": "OfflineDataSync",
      "type": "Client",
      "description": "Syncs LocalProduct with Server Product.",
      "isFunction": false,
      "isPublic": false,
      "inputs": [],
      "outputs": [],
      "flowSummary": "Framework hook for offline sync.",
      "nodes": [
        { "id": "os1", "type": "Start", "label": "Start", "posX": 0, "posY": 0 },
        { "id": "os2", "type": "ExecuteServerAction", "label": "ServerDataSync", "posX": 0, "posY": 100 },
        { "id": "os3", "type": "Action", "label": "UpdateLocalStorage", "posX": 0, "posY": 200 },
        { "id": "os4", "type": "End", "label": "End", "posX": 0, "posY": 300 }
      ],
      "edges": [
        { "id": "eos1", "source": "os1", "target": "os2" },
        { "id": "eos2", "source": "os2", "target": "os3" },
        { "id": "eos3", "source": "os3", "target": "os4" }
      ]
    },
    {
      "id": "act-recipe-cookable",
      "moduleId": "mod-smart-pantry-app",
      "name": "Recipe_FindCookable",
      "type": "Server",
      "description": "Returns recipes where user has all ingredients.",
      "isFunction": true,
      "isPublic": false,
      "inputs": [],
      "outputs": [{ "id": "out-rl", "name": "CookableRecipes", "dataType": "List", "isList": true, "isMandatory": false }],
      "flowSummary": "Knapsack algorithm simulation.",
      "nodes": [
        { "id": "rc1", "type": "Start", "label": "Start", "posX": 0, "posY": 0 },
        { "id": "rc2", "type": "Aggregate", "label": "GetAllRecipes", "posX": 0, "posY": 100 },
        { "id": "rc3", "type": "Loop", "label": "ForEach Recipe", "posX": 0, "posY": 200 },
        { "id": "rc4", "type": "Aggregate", "label": "GetIngredients", "posX": 150, "posY": 200 },
        { "id": "rc5", "type": "If", "label": "Has Inventory?", "posX": 300, "posY": 200 },
        { "id": "rc6", "type": "Assign", "label": "Add to List", "posX": 300, "posY": 300 },
        { "id": "rc7", "type": "End", "label": "End", "posX": 0, "posY": 400 }
      ],
      "edges": [
        { "id": "erc1", "source": "rc1", "target": "rc2" },
        { "id": "erc2", "source": "rc2", "target": "rc3" },
        { "id": "erc3", "source": "rc3", "target": "rc4", "label": "Cycle" },
        { "id": "erc4", "source": "rc4", "target": "rc5" },
        { "id": "erc5", "source": "rc5", "target": "rc6", "label": "True" },
        { "id": "erc6", "source": "rc6", "target": "rc3" },
        { "id": "erc7", "source": "rc5", "target": "rc3", "label": "False" },
        { "id": "erc8", "source": "rc3", "target": "rc7", "label": "End" }
      ]
    },
    {
      "id": "act-export-json",
      "moduleId": "mod-smart-pantry-app",
      "name": "Data_ExportJSON",
      "type": "Server",
      "description": "Exports user data for portability.",
      "isFunction": false,
      "isPublic": true,
      "inputs": [],
      "outputs": [{ "id": "out-file", "name": "FileBinary", "dataType": "Binary", "isList": false, "isMandatory": true }],
      "flowSummary": "Serializes Inventory entities to JSON.",
      "nodes": [
        { "id": "ex1", "type": "Start", "label": "Start", "posX": 0, "posY": 0 },
        { "id": "ex2", "type": "Aggregate", "label": "GetAllData", "posX": 0, "posY": 100 },
        { "id": "ex3", "type": "Action", "label": "JSON Serialize", "posX": 0, "posY": 200 },
        { "id": "ex4", "type": "End", "label": "End", "posX": 0, "posY": 300 }
      ],
      "edges": [
        { "id": "eex1", "source": "ex1", "target": "ex2" },
        { "id": "eex2", "source": "ex2", "target": "ex3" },
        { "id": "eex3", "source": "ex3", "target": "ex4" }
      ]
    }
  ],
  "uiElements": [
    {
      "id": "ui-dashboard",
      "moduleId": "mod-smart-pantry-app",
      "name": "Dashboard",
      "type": "Screen",
      "archetype": "Dashboard",
      "description": "Main overview. Contains 'Red Zone' expiration alerts.",
      "isPublic": false,
      "links": ["ui-scan", "ui-recipes", "ui-shopping", "ui-receipt-scan"],
      "inputs": [],
      "localVariables": [{ "id": "lv-stats", "name": "Stats", "dataType": "Record", "isList": false, "isMandatory": false }]
    },
    {
      "id": "ui-scan",
      "moduleId": "mod-smart-pantry-app",
      "name": "ScanMode",
      "type": "Screen",
      "archetype": "Other",
      "description": "Mobile Camera Overlay for Barcodes.",
      "isPublic": false,
      "links": ["ui-product-detail"],
      "inputs": [],
      "localVariables": []
    },
    {
      "id": "ui-receipt-scan",
      "moduleId": "mod-smart-pantry-app",
      "name": "ScanReceipt",
      "type": "Screen",
      "archetype": "Other",
      "description": "Upload photo for OCR processing.",
      "isPublic": false,
      "links": ["ui-inventory-list"],
      "inputs": [],
      "localVariables": [{ "id": "lv-img", "name": "Image", "dataType": "Binary", "isList": false, "isMandatory": false }]
    },
    {
      "id": "ui-product-detail",
      "moduleId": "mod-smart-pantry-app",
      "name": "ProductDetail",
      "type": "Screen",
      "archetype": "CRUD_Detail",
      "description": "View product info and history.",
      "isPublic": false,
      "links": ["ui-dashboard", "ui-shopping"],
      "inputs": [{ "id": "in-pid", "name": "ProductId", "dataType": "LongInteger", "isList": false, "isMandatory": true }],
      "localVariables": []
    },
    {
      "id": "ui-recipes",
      "moduleId": "mod-smart-pantry-app",
      "name": "RecipeBook",
      "type": "Screen",
      "archetype": "CRUD_List",
      "description": "Gallery of recipes with 'Cookable Now' filter.",
      "isPublic": false,
      "links": ["ui-dashboard"],
      "inputs": [],
      "localVariables": [{ "id": "lv-fil", "name": "OnlyCookable", "dataType": "Boolean", "isList": false, "isMandatory": false }]
    },
    {
      "id": "ui-shopping",
      "moduleId": "mod-smart-pantry-app",
      "name": "ShoppingList",
      "type": "Screen",
      "archetype": "CRUD_List",
      "description": "Items to buy. Shows Average Price Index.",
      "isPublic": false,
      "links": ["ui-dashboard"],
      "inputs": [],
      "localVariables": []
    },
    {
      "id": "ui-inventory-list",
      "moduleId": "mod-smart-pantry-app",
      "name": "InventoryList",
      "type": "Screen",
      "archetype": "CRUD_List",
      "description": "Manage pantry/fridge items.",
      "isPublic": false,
      "links": ["ui-dashboard"],
      "inputs": [],
      "localVariables": []
    }
  ]
}